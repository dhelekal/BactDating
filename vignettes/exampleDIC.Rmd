---
title: "Example of using CreDating"
author: "Xavier Didelot"
date: '`r Sys.Date()`'
output:
  html_notebook: default
  html_document: default
  pdf_document: default
---

##Initialisation

```{r}
library(CreDating)
library(ape)
set.seed(0)
phy <- simdatedtree(nsam = 20, dateroot = 2000)
dates = leafDates(phy)
```

##Analysis

Comparison of strict and relaxed models on a strict dataset:

```{r}
obsphy1=simobsphy(phy, rate=10)
res1=credate(obsphy1,dates)
res2=credate(obsphy1,dates,model='relaxedgamma')
modelcompare(res1,res2)
```

Comparison of strict and relaxed models on a relaxed dataset:

```{r}
obsphy2=simobsphy(phy, rate=10,model='relaxedgamma',ratevar = 100)
res3=credate(obsphy2,dates)
res4=credate(obsphy2,dates,model='relaxedgamma')
modelcompare(res3,res4)
```

Comparison of strict model with and without use of dates:
```{r}
res5=credate(obsphy1,rep(2015,length(dates)))
modelcompare(res1,res5)
```
