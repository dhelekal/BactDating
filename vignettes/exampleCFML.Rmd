---
title: "Example of using CreDating on ClonalFrameML output"
author: "Xavier Didelot"
date: '`r Sys.Date()`'
output:
  pdf_document: default
---

##Initialisation

```{r}
library(CreDating)
library(ape)
set.seed(0)
```

##Data

A ClonalFrameML output can be read using:

```{r eval=FALSE}
cfml=loadCFML(prefix='cfml-output')
```

Instead, for the purpose of making this vignette self-contained, we will simulate a CFML output.
This is just an object of class `phylo`, unrooted and with the added field `unrec`
representing the proportion that is unrecombined for each branch.
```{r}
dates=1990:2010
cfml=unroot(simobsphy(simcoaltree(dates)))
cfml$unrec=runif(length(cfml$edge.length))
plot(cfml)
axisPhylo(backward = F)
edgelabels(round(100*cfml$unrec))
```

##Analysis

We run CreDating as follows:

```{r}
res=credate(cfml,dates,useRec=T)
plot(res,'treeCI')
```

We can see what the MCMC traces look like:

```{r}
plot(res,'trace')
```
