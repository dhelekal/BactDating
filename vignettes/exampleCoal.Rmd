---
title: "Example of using CreDating"
author: "Xavier Didelot"
date: '`r Sys.Date()`'
output:
  html_notebook: default
  html_document: default
  pdf_document: default
---

##Initialisation

```{r}
library(CreDating)
library(ape)
set.seed(0)
```

##Data

We start by generating a coalescent tree with 50 leaves sampled in 2000, 50 leaves sampled in 2010, and
a reciprocal coalescent rate of 10:

```{r}
dates=c(rep(2000,50),rep(2010,50))
phy <- simcoaltree(dates,neg=10)
plot(phy,show.tip.label = F)
axisPhylo(backward = F)
```

On each branch we observe a number of substitutions which is distributed $\mathrm{Gamma}(rl,1)$
where $l$ is the branch length and 
$r=10$ per year is the substitution rate. We can simulate an observed phylogenetic tree
and perform a root-to-tip analysis as follows:

```{r}
obsphy=simobsphy(phy, rate=10,model='gamma')
res=roottotip(obsphy,dates,predInt='gamma',showTree=T)
```

##Analysis

We run CreDating to infer the coalescent rate:

```{r}
res=credate(unroot(obsphy),dates,nbIts = 10000,model='gamma',updateRoot = 2,showProgress=T)
plot(res,'trace')
```
```{r}
plot(res,'treeRoot')
```

